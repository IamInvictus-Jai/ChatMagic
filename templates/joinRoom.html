<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChatMagic - Connect Instantly</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />

    {% load static %}
    <!-- Fav Icon -->
    <link
      rel="icon"
      href="{% static 'images/fav/chat-bubble.ico' %}?v={{ timestamp }}"
    />
    <!-- <link rel="icon" href="/static/images/fav/chat-bubble.ico" /> -->
    <!-- CSS FILES -->
    <link
      rel="stylesheet"
      href="{% static 'css/joinRoom.css' %}?v={{ timestamp }}"
    />
    <link rel="stylesheet" href="/static/css/joinRoom.css?v={{ timestamp }}">
  </head>
  <body>
    <div class="loading-page">
      <div class="loader">
        <div class="logoAnime">
          <span class="loader_text" style="--delay: 2800ms">C</span>
          <span class="loader_text" style="--delay: 2700ms">h</span>
          <span class="loader_text" style="--delay: 2600ms">a</span>
          <span class="loader_text" style="--delay: 2500ms">t</span>
          <span class="loader_text" style="--delay: 2400ms">M</span>
          <span class="loader_text" style="--delay: 2300ms">a</span>
          <span class="loader_text" style="--delay: 2200ms">g</span>
          <span class="loader_text" style="--delay: 2100ms">i</span>
          <span class="loader_text" style="--delay: 2000ms">c</span>
        </div>
        <!-- <div class="spinner"></div> -->
      </div>
    </div>

    <main class="container">
      <h1 class="logo">ChatMagic</h1>
      <p class="tagline">Where Conversations Come Alive âœ¨</p>

      <div class="features">
        <div class="feature">
          <h3>Instant Connection</h3>
          <p>
            Create or join chat rooms in seconds. No registration required. Just
            jump right in and start chatting!
          </p>
        </div>
        <div class="feature">
          <h3>Real-time Magic</h3>
          <p>
            Experience seamless, real-time conversations with crystal-clear
            quality and zero lag.
          </p>
        </div>
        <div class="feature">
          <h3>Safe & Secure</h3>
          <p>
            Your conversations are protected with end-to-end encryption. What
            happens in ChatMagic, stays in ChatMagic.
          </p>
        </div>
      </div>

      <div class="btn-wrapper">
        <h2 class="wrapper-heading floating">Ready to Experience the Magic?</h2>
        <div class="buttons">
          <button class="btn btn-join">Join Room</button>
        </div>
      </div>
    </main>

    <div class="pop-up" aria-modal="true" role="dialog">
      <div class="pop-box">
        <button class="close-btn" aria-label="Close popup">
            <i class="fas fa-times"></i>
        </button>
        <h2 class="cta-heading">Welcome to {{room_creator}} chat room</h2>
        <p class="cta-room-name">{{room_name}}</p>
        <input type="text" aria-label="Username" class="room-input room-user" placeholder="username...">
        <button class="room-btn join">Join</button>
    </div>

    <!-- JS FILES -->
    <script src="{% static 'js/joinRoom.js' %}?v={{ timestamp }}"></script>
    <script src="/static/js/joinRoom.js?v={{ timestamp }}"></script>

    <script>
      const room = "{{room_name}}-{{room_id}}";
      const userName_Input = document.querySelector(".room-user");
      const timestamp = new Date().getTime();

      // Function to handle room joining
      const handleRoom = function (e) {
        e.preventDefault();
        const username = userName_Input.value.trim();

        if (!username) {
          // Shake animation if empty
          userNameInput.classList.add("shake");
          setTimeout(() => userNameInput.classList.remove("shake"), 500);
          return;
        }

        window.location.href = `/chat-magic/redirect-chat-room/?room_id=${room}&username=${username}&_=${timestamp}`;
      };

      document.querySelector(".room-btn.join").addEventListener("click", handleRoom);
    </script>
  </body>
</html>
